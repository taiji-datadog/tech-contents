# Datadog 101: Site Reliability Engineer (Japanese Language, APAC Audience)

## Application Performance Monitoring
このラボでは、StoredogのサービスがAPMのためにどのようにインスツルメンテーションされるかを見て、Datadogアプリで結果のアプリケーショントレースを見ていきます。

学習目標:
ｰ トレースを収集するための言語固有のトレースライブラリを使用して、複数のサービスの構成を確認します。
ｰ DatadogのAPMを理解します。
ｰ アプリケーション・トレースとログの関連性を検証します。
ｰ アプリケーションのプロファイリング設定を確認し、収集されたデータを観察します。


環境の準備ができたら、下の［開始］ボタンをクリックしてください。

### トレースについて
アプリケーションがDatadogエージェントにトレースを送信するように正しく設定されている場合、Datadogはこれらのトレースをインフラストラクチャに関するすべての情報と関連付けることができます。トレース、ログ、プロセス、メトリクス、イベントなどを流動的にナビゲートして、どの時点で何が起きていたかを完全に把握することができます。

アプリケーション・トレースは、アプリケーション・コードでDatadogのAPMライブラリを使用することで可能になります。ライブラリは、収集したトレースをどこにどのように送信するかを知るように設定する必要があります。コンテナ化された環境では、ライブラリが自分自身を構成するために探す環境変数を設定することでこれを行うことができます。

Storedogのコードは、すでにdocker-compose.ymlファイルを使ってインストルメント化され、設定されています。このファイルがどのように作られたかを見てみましょう。

### 設定されたサービスを調べる
これはPostgreSQLデータベースに接続するPython Flaskアプリケーションです。フロントエンドサービスは、ディスカウントコード情報のためにこのサービスにHTTPリクエストを行います。

IDEタブをクリックし、docker-compose.ymlファイルを開きます。

ディスカウントサービスを見て、サービスがAPM用にどのように設定されているかを確認しましょう：
![specific_wizard_values_in_compose](https://github.com/taiji-datadog/tech-contents/assets/114374807/4237e757-4247-4626-8cf0-3fdd9a524239)

44行目のDD_SERVICE_MAPPINGは、ddtraceがPostgreSQL接続を検出したときにデフォルトで使用するpostgresではなく、サービス名データベースを使用するように指示します。

46行目のDD_AGENT_HOSTは、datadogサービスにトレースを送信するようddtraceライブラリに指示します。

48行目のコマンドは、コンテナのデフォルト・コマンドをオーバーライドし、アプリケーションを起動するコマンドにddtrace-runを追加します。

ディスカウント・サービス・アプリケーションがAPMにトレースを送信していることを確認します。

ラボのターミナルで、Agent status コマンドを実行します:

``docker-compose exec datadog``

APM Agentセクションまでスクロールします。ディスカウントサービスからPythonのトレースを受信しています：
![agent_check_apm](https://github.com/taiji-datadog/tech-contents/assets/114374807/fcb515f9-4826-4e6b-a0b4-b0423496cf5f)

Datadogは、APMウィザードを使ってこのコンフィギュレーションを構築することができます、 ワークショップの後、各自で調べてみてください。

### Datadogのトレースを見てみる
コンテナ化されたアプリケーションでAPMを設定する方法を調べたので、Datadogで結果のトレースを見てみましょう。

1. ラボで作成した認証情報を使用して Datadog にログインします。Datadog トレーニング アカウントの認証情報を取得する必要がある場合は、いつでもラボのターミナルで creds を実行できます。
2. 始める前に、 ロ グ を有効にす る 必要があ り ます。 Logs] に移動します。
3. [Get Started] ボタンをクリックします。




